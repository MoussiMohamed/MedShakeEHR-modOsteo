UPDATE `system` SET `value`='v0.3.0' WHERE `groupe`='module' and `name`='osteo';

-- forms
SET @catID = (SELECT forms_cat.id FROM forms_cat WHERE forms_cat.name='formCS');
INSERT IGNORE INTO `forms` (`module`, `internalName`, `name`, `description`, `dataset`, `groupe`, `formMethod`, `formAction`, `cat`, `type`, `yamlStructure`, `options`, `printModel`, `cda`, `javascript`) VALUES
('osteo', 'osteoConsult', 'Formulaire CS', 'formulaire de consultation osteo', 'data_types', 'medical', 'post', '/patient/ajax/saveCsForm/ignoreEmpty/', @catID, 'public', 'global:\r\n  formClass: \'osteoCS hide\' \r\nstructure:\r\n####### INTRODUCTION ######\r\n  row1:                              \r\n    class: \'osteoAnamnese\'\r\n    head: \'Anamnèse\'\r\n    col1:                              \r\n      size: 12\r\n      bloc:                          \r\n        - osteoAnamnese,nolabel,rows=2             		#210  \n  row2:                              \r\n    class: \'osteoTests\'\r\n    head: \'Tests\'\r\n    col1:                              \r\n      size: 12\r\n      bloc:                          \r\n        - osteoTests,nolabel,rows=2                		#212  \n  row3:\r\n    class: \'osteoOArray\'\r\n    col1:\r\n      size: 12\r\n      bloc:\r\n         - osteoObservation,nolabel, row=2         		#211  En attendant un schéma\n  row4:\r\n    head: \'Diagnostic\'\r\n    col1:                              \r\n      size: 12\r\n      bloc:                          \r\n        - osteoDiagnostic,nolabel                  		#213  \n  row5:\r\n    head: \'Traitement\'\r\n    col1:                              \r\n      size: 12\r\n      bloc:                          \r\n        - osteoTraitement,nolabel,row=2            		#214  \n row6:\r\n    head: \'Notes\'\r\n    col1:                              \r\n      size: 12\r\n      bloc:                          \r\n        - osteoNotes,nolabel,row=2                 		#215  Notes\n row7:\r\n    class: \'osteoVArray\'\r\n    col1:                              \r\n      size: 12\r\n      bloc:\r\n        - template{osteoConsult}                  		\n        - osteoCuneiforme_I_Gch,nolabel            		#240  Cunéïforme I Gch\n        - osteoCuneiforme_I_Drt,nolabel            		#241  Cunéïforme I Drt\n        - osteoCuneiforme_II_Gch,nolabel           		#238  Cunéïforme II Gch\n        - osteoCuneiforme_II_Drt,nolabel           		#239  Cunéïforme II Drt\n        - osteoCuneiforme_III_Gch,nolabel          		#236  Cunéïforme III Gch\n        - osteoCuneiforme_III_Drt,nolabel          		#237  Cunéïforme III Drt\n        - osteoCalcaneum_Gch,nolabel               		#228  Calcanéum Gch\n        - osteoCalcaneum_Drt,nolabel               		#229  Calcanéum Drt\n        - osteoCapitatum_Gch,nolabel               		#230  Capitatum Gch\n        - osteoCapitatum_Drt,nolabel               		#231  Capitatum Drt\n        - osteoCuboide_Gch,nolabel                 		#234  Cuboïde Gch\n        - osteoCuboide_Drt,nolabel                 		#235  Cuboïde Drt\n        - osteoHamatum_Gch,nolabel                 		#246  Hamatum Gch\n        - osteoHamatum_Drt,nolabel                 		#247  Hamatum Drt\n        - osteoIlium_Gch,nolabel                   		#248  Ilium Gch\n        - osteoIlium_Drt,nolabel                   		#249  Ilium Drt\n        - osteoLunatum_Gch,nolabel                 		#279  Lunatum Gch\n        - osteoLunatum_Drt,nolabel                 		#280  Lunatum Drt\n        - osteoMetacarpe_I_Gch,nolabel             		#287  Métacarpe I Gch\n        - osteoMetacarpe_I_Drt,nolabel             		#288  Métacarpe I Drt\n        - osteoMetacarpe_II_Gch,nolabel            		#283  Métacarpe II Gch\n        - osteoMetacarpe_II_Drt,nolabel            		#284  Métacarpe II Drt\n        - osteoMetacarpe_III_Gch,nolabel           		#281  Métacarpe III Gch\n        - osteoMetacarpe_III_Drt,nolabel           		#282  Métacarpe III Drt\n        - osteoMetacarpe_IV_Gch,nolabel            		#285  Métacarpe IV Gch\n        - osteoMetacarpe_IV_Drt,nolabel            		#286  Métacarpe IV Drt\n        - osteoMetacarpe_V_Gch,nolabel             		#289  Métacarpe V Gch\n        - osteoMetacarpe_V_Drt,nolabel             		#290  Métacarpe V Drt\n        - osteoNaviculaire_Gch,nolabel             		#303  Naviculaire Gch\n        - osteoNaviculaire_Drt,nolabel             		#304  Naviculaire Drt\n        - osteoP1_I_Gch,nolabel                    		#311  P1 I Gch\n        - osteoP1_I_Drt,nolabel                    		#312  P1 I Drt\n        - osteoP1_II_Gch,nolabel                   		#307  P1 II Gch\n        - osteoP1_II_Drt,nolabel                   		#308  P1 II Drt\n        - osteoP1_III_Gch,nolabel                  		#305  P1 III Gch\n        - osteoP1_III_Drt,nolabel                  		#306  P1 III Drt\n        - osteoP1_IV_Gch,nolabel                   		#309  P1 IV Gch\n        - osteoP1_IV_Drt,nolabel                   		#310  P1 IV Drt\n        - osteoP1_V_Gch,nolabel                    		#313  P1 V Gch\n        - osteoP1_V_Drt,nolabel                    		#314  P1 V Drt\n        - osteoP2_I_Gch,nolabel                    		#321  P2 I Gch\n        - osteoP2_I_Drt,nolabel                    		#322  P2 I Drt\n        - osteoP2_II_Gch,nolabel                   		#317  P2 II Gch\n        - osteoP2_II_Drt,nolabel                   		#318  P2 II Drt\n        - osteoP2_III_Gch,nolabel                  		#315  P2 III Gch\n        - osteoP2_III_Drt,nolabel                  		#316  P2 III Drt\n        - osteoP2_IV_Gch,nolabel                   		#319  P2 IV Gch\n        - osteoP2_IV_Drt,nolabel                   		#320  P2 IV Drt\n        - osteoP2_V_Gch,nolabel                    		#323  P2 V Gch\n        - osteoP2_V_Drt,nolabel                    		#324  P2 V Drt\n        - osteoP3_II_Gch,nolabel                   		#327  P3 II Gch\n        - osteoP3_II_Drt,nolabel                   		#328  P3 II Drt\n        - osteoP3_III_Gch,nolabel                  		#325  P3 III Gch\n        - osteoP3_III_Drt,nolabel                  		#326  P3 III Drt\n        - osteoP3_IV_Gch,nolabel                   		#329  P3 IV Gch\n        - osteoP3_IV_Drt,nolabel                   		#330  P3 IV Drt\n        - osteoP3_V_Gch,nolabel                    		#331  P3 V Gch\n        - osteoP3_V_Drt,nolabel                    		#332  P3 V Drt\n        - osteo_p1_I_Gch,nolabel                   		#385  p1 I Gch\n        - osteo_p1_I_Drt,nolabel                   		#386  p1 I Drt\n        - osteo_p1_II_Gch,nolabel                  		#381  p1 II Gch\n        - osteo_p1_II_Drt,nolabel                  		#382  p1 II Drt\n        - osteo_p1_III_Gch,nolabel                 		#379  p1 III Gch\n        - osteo_p1_III_Drt,nolabel                 		#380  p1 III Drt\n        - osteo_p1_IV_Gch,nolabel                  		#383  p1 IV Gch\n        - osteo_p1_IV_Drt,nolabel                  		#384  p1 IV Drt\n        - osteo_p1_V_Gch,nolabel                   		#387  p1 V Gch\n        - osteo_p1_V_Drt,nolabel                   		#388  p1 V Drt\n        - osteo_p2_I_Gch,nolabel                   		#395  p2 I Gch\n        - osteo_p2_I_Drt,nolabel                   		#396  p2 I Drt\n        - osteo_p2_II_Gch,nolabel                  		#391  p2 II Gch\n        - osteo_p2_II_Drt,nolabel                  		#392  p2 II Drt\n        - osteo_p2_III_Gch,nolabel                 		#389  p2 III Gch\n        - osteo_p2_III_Drt,nolabel                 		#390  p2 III Drt\n        - osteo_p2_IV_Gch,nolabel                  		#393  p2 IV Gch\n        - osteo_p2_IV_Drt,nolabel                  		#394  p2 IV Drt\n        - osteo_p2_V_Gch,nolabel                   		#397  p2 V Gch\n        - osteo_p2_V_Drt,nolabel                   		#398  p2 V Drt\n        - osteoPatella_Gch,nolabel                 		#333  Patella Gch\n        - osteoPatella_Drt,nolabel                 		#334  Patella Drt\n        - osteoPisiforme_Gch,nolabel               		#335  Pisiforme Gch\n        - osteoPisiforme_Drt,nolabel               		#336  Pisiforme Drt\n        - osteoSacrum,nolabel                      		#337  Sacrum\n        - osteoScaphoide_Gch,nolabel               		#338  Scaphoïde Gch\n        - osteoScaphoide_Drt,nolabel               		#339  Scaphoïde Drt\n        - osteoScapula_Gch,nolabel                 		#340  Scapula Gch\n        - osteoScapula_Drt,nolabel                 		#341  Scapula Drt\n        - osteoTalus_Gch,nolabel                   		#359  Talus Gch\n        - osteoTalus_Drt,nolabel                   		#360  Talus Drt\n        - osteoTibia_Gch,nolabel                   		#363  Tibia Gch\n        - osteoTibia_Drt,nolabel                   		#364  Tibia Drt\n        - osteoTrapezium_Gch,nolabel               		#369  Trapezium Gch\n        - osteoTrapezium_Drt,nolabel               		#370  Trapezium Drt\n        - osteoTrapezoide_Gch,nolabel              		#371  Trapézoïde Gch\n        - osteoTrapezoide_Drt,nolabel              		#372  Trapézoïde Drt\n        - osteoTriquetrum_Gch,nolabel              		#373  Triquetrum Gch\n        - osteoTriquetrum_Drt,nolabel              		#374  Triquetrum Drt\n        - osteoMetatarse_I_Gch,nolabel             		#297  Métatarse I Gch\n        - osteoMetatarse_I_Drt,nolabel             		#298  Métatarse I Drt\n        - osteoMetatarse_II_Gch,nolabel            		#293  Métatarse II Gch\n        - osteoMetatarse_II_Drt,nolabel            		#294  Métatarse II Drt\n        - osteoMetatarse_III_Gch,nolabel           		#291  Métatarse III Gch\n        - osteoMetatarse_III_Drt,nolabel           		#292  Métatarse III Drt\n        - osteoMetatarse_IV_Gch,nolabel            		#295  Métatarse IV Gch\n        - osteoMetatarse_IV_Drt,nolabel            		#296  Métatarse IV Drt\n        - osteoMetatarse_V_Gch,nolabel             		#299  Métatarse V Gch\n        - osteoMetatarse_V_Drt,nolabel             		#300  Métatarse V Drt\n        - osteoMetatarso_phalangienne_Gch,nolabel  		#301  Métatarso-phalangienne Gch\n        - osteoMetatarso_phalangienne_Drt,nolabel  		#302  Métatarso-phalangienne Drt\n        - osteoTibio_fibulaire_distale_Gch,nolabel 		#365  Tibio-fibulaire distale Gch\n        - osteoTibio_fibulaire_distale_Drt,nolabel 		#366  Tibio-fibulaire distale Drt\n        - osteoATM_Gch,nolabel                     		#216  ATM Gch\n        - osteoATM_Drt,nolabel                     		#217  ATM Drt\n        - osteoSterno_claviculaire_Gch,nolabel     		#342  Sterno-claviculaire Gch\n        - osteoSterno_claviculaire_Drt,nolabel     		#343  Sterno-claviculaire Drt\n        - osteoAcromio_claviculaire_Gch,nolabel    		#218  Acromio-claviculaire Gch\n        - osteoAcromio_claviculaire_Drt,nolabel    		#219  Acromio-claviculaire Drt\n        - osteoGleno_humerale_Gch,nolabel          		#244  Gléno-humérale Gch\n        - osteoGleno_humerale_Drt,nolabel          		#245  Gléno-humérale Drt\n        - osteoTete_radiale_Gch,nolabel            		#361  Tête radiale Gch\n        - osteoTete_radiale_Drt,nolabel            		#362  Tête radiale Drt\n        - osteoUlna_proximal_Gch,nolabel           		#377  Ulna proximal Gch\n        - osteoUlna_proximal_Drt,nolabel           		#378  Ulna proximal Drt\n        - osteoFemoro_acetabulaire_Gch,nolabel     		#242  Fémoro-acétabulaire Gch\n        - osteoFemoro_acetabulaire_Drt,nolabel     		#243  Fémoro-acétabulaire Drt\n        - osteoTibio_fibulaire_prox_Gch,nolabel    		#367  Tibio-fibulaire prox Gch\n        - osteoTibio_fibulaire_prox_Drt,nolabel    		#368  Tibio-fibulaire prox Drt\n        - osteoSymphyse,nolabel                    		#346  Symphyse\n        - osteoStyloide_radiale_Gch,nolabel        		#344  Styloïde radiale Gch\n        - osteoStyloide_radiale_Drt,nolabel        		#345  Styloïde radiale Drt\n        - osteoUlna_distal_Gch,nolabel             		#375  Ulna distal Gch\n        - osteoUlna_distal_Drt,nolabel             		#376  Ulna distal Drt\n        - osteoC0,nolabel                          		#220  C0\n        - osteoC1,nolabel                          		#221  C1\n        - osteoC2,nolabel                          		#222  C2\n        - osteoC3,nolabel                          		#223  C3\n        - osteoC4,nolabel                          		#224  C4\n        - osteoC5,nolabel                          		#225  C5\n        - osteoC6,nolabel                          		#226  C6\n        - osteoC7,nolabel                          		#227  C7\n        - osteoT1,nolabel                          		#347  T1\n        - osteoT2,nolabel                          		#351  T2\n        - osteoT3,nolabel                          		#352  T3\n        - osteoT4,nolabel                          		#353  T4\n        - osteoT5,nolabel                          		#354  T5\n        - osteoT6,nolabel                          		#355  T6\n        - osteoT7,nolabel                          		#356  T7\n        - osteoT8,nolabel                          		#357  T8\n        - osteoT9,nolabel                          		#358  T9\n        - osteoT10,nolabel                         		#348  T10\n        - osteoT11,nolabel                         		#349  T11\n        - osteoT12,nolabel                         		#350  T12\n        - osteoK1_Gch,nolabel                      		#256  K1 Gch\n        - osteoK1_Drt,nolabel                      		#257  K1 Drt\n        - osteoK2_Gch,nolabel                      		#258  K2 Gch\n        - osteoK2_Drt,nolabel                      		#259  K2 Drt\n        - osteoK3_Gch,nolabel                      		#260  K3 Gch\n        - osteoK3_Drt,nolabel                      		#261  K3 Drt\n        - osteoK4_Gch,nolabel                      		#262  K4 Gch\n        - osteoK4_Drt,nolabel                      		#263  K4 Drt\n        - osteoK5_Gch,nolabel                      		#264  K5 Gch\n        - osteoK5_Drt,nolabel                      		#265  K5 Drt\n        - osteoK6_Gch,nolabel                      		#266  K6 Gch\n        - osteoK6_Drt,nolabel                      		#267  K6 Drt\n        - osteoK7_Gch,nolabel                      		#268  K7 Gch\n        - osteoK7_Drt,nolabel                      		#269  K7 Drt\n        - osteoK8_Gch,nolabel                      		#270  K8 Gch\n        - osteoK8_Drt,nolabel                      		#271  K8 Drt\n        - osteoK9_Gch,nolabel                      		#272  K9 Gch\n        - osteoK9_Drt,nolabel                      		#273  K9 Drt\n        - osteoK10_Gch,nolabel                     		#250  K10 Gch\n        - osteoK10_Drt,nolabel                     		#251  K10 Drt\n        - osteoK11_Gch,nolabel                     		#252  K11 Gch\n        - osteoK11_Drt,nolabel                     		#253  K11 Drt\n        - osteoK12_Gch,nolabel                     		#254  K12 Gch\n        - osteoK12_Drt,nolabel                     		#255  K12 Drt\n        - osteoL1,nolabel                          		#274  L1\n        - osteoL2,nolabel                          		#275  L2\n        - osteoL3,nolabel                          		#276  L3\n        - osteoL4,nolabel                          		#277  L4\n        - osteoL5,nolabel                          		#278  L5\n        - osteoCoccyx,nolabel                      		#232  Coccyx', '', 'csOsteo', '', '$(document).ready(function() {\r\n  //ajutement auto des textarea en hauteur\r\n  autosize($(\'#formName_osteoConsult textarea\')); \r\n\r\n  if (!$(\".mousehelper\").length) \r\n    $(\"body\").append(\'<div class=\"helper hide mousehelper\"></div>\');\r\n\r\n  if (!$(\".svgMenuSingle\").length)\r\n    $(\"body\").append(\'\\\r\n      <ul class=\"dropdown-menu svgMenuSingle\" role=\"menu\" style=\"display:none;position:absolute;\" >\\\r\n          <li id=\"title><span tabindex=\"-1\" style=\"margin-left:20px;margin-right:10px;font-weight:700\">Menu</span></li>\\\r\n          <li class=\"dropdown-divider\"></li>\\\r\n      </ul>\');\r\n  if (!$(\".svgMenuMulti\").length)\r\n    $(\"body\").append(\'\\\r\n      <ul class=\"dropdown-menu svgMenuMulti\" role=\"menu\" style=\"display:none;position:absolute;\" >\\\r\n          <li id=\"title><span tabindex=\"-1\" style=\"margin-left:20px;margin-right:10px;font-weight:700\">Menu</span></li>\\\r\n          <li class=\"dropdown-divider\"></li>\\\r\n      </ul>\');\r\n\r\n\r\n  $(\"#navosteo\").insertAfter(\".osteoTests\");\r\n  $(\"#tabosteo\").insertAfter(\"#navosteo\");\r\n  $(\".osteoVArray\").appendTo(\"#zonesdo\");\r\n  $(\".osteoOArray\").appendTo(\"#observation\");\r\n $(\".osteoCS.hide\").removeClass(\"hide\");\r\n\r\n  (function() {\r\n\r\n    $(\'[data-toggle=\"popover\"]\').popover({container: \"#svgparent\"});\r\n\r\n    function checkall($d) {\r\n      var setmatrix = false;\r\n      var m = $d.panzoom(\"getMatrix\");\r\n      for (var i = 0; i < 6; i++) m[i] = parseInt(m[i]);\r\n      var w = $d.width();\r\n      var h = $d.height();\r\n      var wp = $d.parent().width();\r\n      var hp = $d.parent().height();\r\n      var limits = [w*(m[0]+1)/2-200, wp+w*(m[0]-1)/2-200, h*(m[0]+1)/2-200, hp+h*(m[0]-1)/2-200];\r\n\r\n      if (m[4] < -limits[0]){\r\n        m[4] = -limits[0];\r\n        setmatrix = true;\r\n      }\r\n      else if (m[4] > limits[1]){\r\n        m[4] = limits[1];\r\n        setmatrix = true;\r\n      };\r\n      if (m[5] < -limits[2]){\r\n        m[5] = -limits[2];\r\n        setmatrix = true;\r\n      }\r\n      else if (m[5] > limits[3]){\r\n        m[5] = limits[3];\r\n        setmatrix = true;\r\n      }\r\n      if (setmatrix)\r\n        $d.panzoom(\"pan\",m[4],m[5]);\r\n    }\r\n\r\n    var clickTO;\r\n    var $panzoom = $(\'.panzoom\').panzoom({\r\n        cursor:\"default\",\r\n        minScale: 1,\r\n        maxScale: 4,\r\n        transition: $(window).width()>=1024,\r\n        $zoomIn: $(\".zoomIn\"),\r\n        $zoomOut: $(\".zoomOut\"),\r\n        onStart: function(){\r\n          clickTO=setTimeout(function(){\r\n            $(\"#skeleton\").css(\"cursor\",\"move\");\r\n            clickTO=undefined;\r\n          }, 100)\r\n        },\r\n        onEnd: function(){\r\n          checkall($(this));\r\n          $(\"#skeleton\").css(\"cursor\",\"default\");\r\n          if (clickTO)\r\n            clearTimeout(clickTO)\r\n        }\r\n    });\r\n    $panzoom.parent().on(\'mousewheel.focal\', function( e ) {\r\n      if (e.ctrlKey==1) {\r\n        var delta = e.delta || e.originalEvent.wheelDelta;\r\n        var zoomOut = delta ? delta < 0 : e.originalEvent.deltaY > 0;\r\n        e.preventDefault();\r\n        $panzoom.panzoom(\'zoom\', zoomOut, {\r\n          minScale: 1,\r\n          maxScale: 4,\r\n          animate:false,\r\n          focal: e\r\n        });\r\n      };\r\n    });\r\n  })();\r\n\r\n  function setOsteoSelected(entry){\r\n    if (entry) {\r\n      var $entry = $(\"input[placeholder=\'\"+entry+\"\']\");\r\n      if (!$entry.length)\r\n        return;\r\n      var $svgOs = $(\".os[value=\'\"+entry+\"\']\");\r\n      var $svgArt = $(\".articulation[value=\'\"+entry+\"\']\");\r\n      var value = $entry.attr(\"value\");\r\n      if ($svgOs.length)\r\n        $svgOs.each(function(idx,el){\r\n          if (!value || value == \"\")\r\n            el.className.baseVal = el.className.baseVal.replace(\" selected\",\"\");\r\n          else if (el.className.baseVal.indexOf(\" selected\") < 0)\r\n            el.className.baseVal += \" selected\";\r\n        });\r\n      else if ($svgArt.length)\r\n        $svgArt.each(function(idx,el){\r\n          if (!value || value == \"\" && el.className.baseVal.indexOf(\" nonvisible\") < 0)\r\n            el.className.baseVal += \" nonvisible\";\r\n          else\r\n            el.className.baseVal = el.className.baseVal.replace(\" nonvisible\",\"\");\r\n        });\r\n    }\r\n    else\r\n    {\r\n      $(\"input[type=hidden]\").each(function(index, element){\r\n        var entry = $(element).attr(\"placeholder\");\r\n        if (!entry || entry == \"\")\r\n          return;\r\n        var $svgOs = $(\".os[value=\'\"+entry+\"\']\");\r\n        var $svgArt = $(\".articulation[value=\'\"+entry+\"\']\");\r\n        var value = $(element).attr(\"value\");\r\n        if ($svgOs.length)\r\n          $svgOs.each(function(idx,el){\r\n            if (!value || value == \"\")\r\n              el.className.baseVal = el.className.baseVal.replace(\" selected\",\"\");\r\n            else if (el.className.baseVal.indexOf(\" selected\") < 0)\r\n              el.className.baseVal += \" selected\";\r\n          });\r\n        else if ($svgArt.length)\r\n          $svgArt.each(function(idx,el){\r\n            if ((!value || value == \"\") && el.className.baseVal.indexOf(\" nonvisible\") < 0)\r\n              el.className.baseVal += \" nonvisible\";\r\n            else if (value && value != \"\")\r\n              el.className.baseVal = el.className.baseVal.replace(\" nonvisible\",\"\");\r\n          });\r\n      });\r\n    }\r\n  }\r\n  setOsteoSelected();\r\n\r\n  function svgFit(animate){\r\n    var $s = $(\"#skeleton\");\r\n    $s.panzoom(\'setMatrix\', [1, 0, 0, 1, ($s.parent().width() - 20 - $s.width()) / 2, 10], {animate:animate});\r\n    $s.parent().height($s.height()+20);\r\n  };\r\n  svgFit(false);\r\n  \r\n  $(document).scroll(function(e){\r\n    if ($(\"#svgparent\").length)\r\n      $(\".tools\").css(\"top\", Math.min($(\"#svgparent\").height()-$(\".tools\").height()+20, Math.max(0, e.pageY+60-$(\"#svgparent\").offset().top)));\r\n  });\r\n\r\n  $(\"body\").on(\"touchstart\", \"#skeleton\", function(e){\r\n    if(e.touches.length>1)\r\n      e.stopPropagation();\r\n  });\r\n\r\n  $(\"body\").on(\"touchstart\", \"path,g,div,svg,form\", function(e){\r\n    if(e.touches.length > 1)\r\n      e.preventDefault();\r\n  });\r\n\r\n  $(\"body\").on(\"touchmove\", \"path,g,div,svg,form\", function(e){\r\n    if(e.touches.length > 1)\r\n      e.preventDefault();\r\n  });\r\n\r\n  $(\"body\").on(\"mousedown\", \".showAll\", function(){\r\n    $(\".os:not(.show),.articulation:not(.show)\").each(function(idx,el){el.className.baseVal+=\" show\"})\r\n  });\r\n  $(\"body\").on(\"mouseup\", \".showAll\", function(){\r\n    $(\".selectable,.os,.articulation\").each(function(idx,el){el.className.baseVal=el.className.baseVal.replace(\" show\", \"\")})\r\n  });\r\n\r\n  $(\"body\").on(\"click\", \".zoomFit\", function(){\r\n    svgFit(true);\r\n  });\r\n  $(window).on(\"resize\", function(){\r\n    svgFit(true);\r\n  });\r\n\r\n  $(\"body\").on(\"click\", \".menuSingle\", function (e) {\r\n    var $menu = $(\".svgMenuSingle\")\r\n      .show()\r\n      .css({left: Math.max(0, e.pageX-50), top: Math.max(0, e.pageY-50)})\r\n      .off(\'click\')\r\n      .on(\"mouseleave\", function(){\r\n        $(this).hide()\r\n        .children(\"li:nth-child(n+3)\").remove();\r\n      })\r\n      .on(\'click\', \'a\', function (e) {\r\n        e.stopImmediatePropagation();\r\n        var chk = $(this).children(\"input\").prop(\"checked\");\r\n        $(this).parent().parent().find(\"input\").prop(\"checked\", false);\r\n        $(this).children(\"input\").prop(\"checked\", !chk);\r\n        //on fixe la valeur de l\'entrée de formulaire\r\n        var $entry = $(\"input[placeholder=\'\"+$(this).attr(\'data-entry\')+\"\']\");\r\n        var value = $(this).attr(\'data-value\');\r\n        if (chk)\r\n          $entry.attr(\"value\", \"\");\r\n        else\r\n          $entry.attr(\"value\", value);\r\n        setOsteoSelected($(this).attr(\'data-entry\'));\r\n      });\r\n    var title = $(this).attr(\"value\");\r\n    var items = $(this).attr(\"menu\").trim().split(\",\");\r\n    $menu.children().first().html(title);\r\n    $menu.children((\"li:gt(1)\")).remove();\r\n    for (var i=0; i< items.length; i++)\r\n      $menu.append(\'<li><a tabindex=\"-1\" style=\"text-decoration:none;color:#484848\" class=\"containerCheck\" data-entry=\"\'+title\r\n      + \'\" data-value=\"\' +items[i]+\r\n      \'\">\'+items[i]+\'<input type=\"radio\"\'+($(\"input[placeholder=\'\"+title+\"\']\").attr(\"value\") == items[i] ? \' checked\' : \'\')+\r\n      \'></input><span class=\"checkmarkRadio\"></span></a></li>\');\r\n    return false;\r\n  });\r\n\r\n  $(\"body\").on(\"click\", \".menuMulti\", function (e) {\r\n    var $menu = $(\".svgMenuMulti\")\r\n      .show()\r\n      .css({left: Math.max(0, e.pageX-50), top: Math.max(0, e.pageY-50)})\r\n      .off(\'click\')\r\n      .on(\"mouseleave\", function(){\r\n        $(this).hide()\r\n        .children(\"li:nth-child(n+3)\").remove();\r\n      })\r\n      .on(\'click\', \'a\', function (e) {\r\n        e.stopImmediatePropagation();\r\n        var chk = $(this).children(\"input\").attr(\"checked\");\r\n        if (chk)\r\n          $(this).children(\"input\").removeAttr(\"checked\");\r\n        else\r\n          $(this).children(\"input\").attr(\"checked\",\"\");\r\n        //on fixe la valeur de l\'entrée de formulaire\r\n        var $entry = $(\"input[placeholder=\'\"+$(this).attr(\'data-entry\')+\"\']\");\r\n        var value = $entry.attr(\"value\");\r\n        var newValue = $(this).attr(\'data-value\');\r\n        var idx;\r\n        if (value && (idx=value.trim().split(\",\").findIndex(function(v){return v==newValue})) >= 0)\r\n          $entry.attr(\"value\",value.trim().split(\",\").filter(function(v,i){return i!=idx}).join());\r\n        else if (value && value != \"\")\r\n          $entry.attr(\"value\", value + \",\" + newValue);\r\n        else\r\n          $entry.attr(\"value\", newValue);\r\n        setOsteoSelected($(this).attr(\'data-entry\'));\r\n      });\r\n    var title = $(this).attr(\"value\");\r\n    var items = $(this).attr(\"menu\").trim().split(\",\");\r\n    var value = $(\"input[placeholder=\'\"+title+\"\']\").attr(\"value\");\r\n    $menu.children().first().html(title);\r\n    $menu.children((\"li:gt(1)\")).remove();\r\n    for (var i=0; i< items.length; i++)\r\n      $menu.append(\'<li><a tabindex=\"-1\" style=\"text-decoration:none;color:#484848\" class=\"containerCheck\" data-entry=\"\'+title\r\n      + \'\" data-value=\"\' +items[i]+\r\n      \'\">\'+items[i]+\'<input type=\"checkbox\"\'+ ((value && value.trim().split(\",\").findIndex(function(v){return v==items[i]}) >= 0) ? \' checked\' : \'\')+\r\n      \'></input><span class=\"checkmarkCheck\"></span></a></li>\');\r\n    return false;\r\n  });\r\n\r\n  $(\"body\").on(\"click\", function(){\r\n    $(\".svgMenuSingle,.svgMenuMulti\").hide().children(\"li:nth-child(n+3)\").remove();\r\n  });\r\n\r\n  $(\"body\").on(\"click\", \".noMenu\", function(e){\r\n    e.stopImmediatePropagation();\r\n    var $entry = $(\"input[placeholder=\'\"+$(this).attr(\"value\")+\"\']\");\r\n    if ($entry.attr(\"value\") == \"true\")\r\n      $entry.attr(\"value\", \"\");\r\n    else\r\n      $entry.attr(\"value\", \"true\");\r\n    setOsteoSelected($(this).attr(\"value\"));\r\n  });\r\n\r\n  $(\"body\").on(\"mouseenter\", \".os,.articulation\", function(e){\r\n      this.className.baseVal+=\" show\";\r\n      $(\"#mousehelper\").html($(this).attr(\"value\"))\r\n      .removeClass(\"hide\").css(\"left\", (e.pageX-100)+\"px\").css(\"top\", (e.pageY-50)+\"px\");\r\n  });\r\n\r\n  $(\"body\").on(\"mouseleave\", \".show\", function(){\r\n    if(this.className.baseVal) this.className.baseVal=this.className.baseVal.replace(\" show\", \"\");\r\n    $(\"#mousehelper:not(.hide)\").html(\"\").addClass(\"hide\");\r\n  });\r\n\r\n});')
ON DUPLICATE KEY UPDATE module=values(module), internalName=values(internalName), name=values(name), description=values(description), dataset=values(dataset), groupe=values(groupe), formMethod=values(formMethod), formAction=values(formAction), cat=@catID, type=values(type), yamlStructure=values(yamlStructure), options=values(options), printModel=values(printModel), cda=values(cda), javascript=values(javascript);

